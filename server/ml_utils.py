import pickle
import os

data_dict = {
  'itching': {'weight': 1},
  'skin_rash': {'weight': 3},
  'nodal_skin_eruptions': {'weight': 4},
  'continuous_sneezing': {'weight': 4},
  'shivering': {'weight': 5},
  'chills': {'weight': 3},
  'joint_pain': {'weight': 3},
  'stomach_pain': {'weight': 5},
  'acidity': {'weight': 3},
  'ulcers_on_tongue': {'weight': 4},
  'muscle_wasting': {'weight': 3},
  'vomiting': {'weight': 5},
  'burning_micturition': {'weight': 6},
  'spotting_urination': {'weight': 6},
  'fatigue': {'weight': 4},
  'weight_gain': {'weight': 3},
  'anxiety': {'weight': 4},
  'cold_hands_and_feets': {'weight': 5},
  'mood_swings': {'weight': 3},
  'weight_loss': {'weight': 3},
  'restlessness': {'weight': 5},
  'lethargy': {'weight': 2},
  'patches_in_throat': {'weight': 6},
  'irregular_sugar_level': {'weight': 5},
  'cough': {'weight': 4},
  'high_fever': {'weight': 7},
  'sunken_eyes': {'weight': 3},
  'breathlessness': {'weight': 4},
  'sweating': {'weight': 3},
  'dehydration': {'weight': 4},
  'indigestion': {'weight': 5},
  'headache': {'weight': 3},
  'yellowish_skin': {'weight': 3},
  'dark_urine': {'weight': 4},
  'nausea': {'weight': 5},
  'loss_of_appetite': {'weight': 4},
  'pain_behind_the_eyes': {'weight': 4},
  'back_pain': {'weight': 3},
  'constipation': {'weight': 4},
  'abdominal_pain': {'weight': 4},
  'diarrhoea': {'weight': 6},
  'mild_fever': {'weight': 5},
  'yellow_urine': {'weight': 4},
  'yellowing_of_eyes': {'weight': 4},
  'acute_liver_failure': {'weight': 6},
  'fluid_overload': {'weight': 4},
  'swelling_of_stomach': {'weight': 7},
  'swelled_lymph_nodes': {'weight': 6},
  'malaise': {'weight': 6},
  'blurred_and_distorted_vision': {'weight': 5},
  'phlegm': {'weight': 5},
  'throat_irritation': {'weight': 4},
  'redness_of_eyes': {'weight': 5},
  'sinus_pressure': {'weight': 4},
  'runny_nose': {'weight': 5},
  'congestion': {'weight': 5},
  'chest_pain': {'weight': 7},
  'weakness_in_limbs': {'weight': 7},
  'fast_heart_rate': {'weight': 5},
  'pain_during_bowel_movements': {'weight': 5},
  'pain_in_anal_region': {'weight': 6},
  'bloody_stool': {'weight': 5},
  'irritation_in_anus': {'weight': 6},
  'neck_pain': {'weight': 5},
  'dizziness': {'weight': 4},
  'cramps': {'weight': 4},
  'bruising': {'weight': 4},
  'obesity': {'weight': 4},
  'swollen_legs': {'weight': 5},
  'swollen_blood_vessels': {'weight': 5},
  'puffy_face_and_eyes': {'weight': 5},
  'enlarged_thyroid': {'weight': 6},
  'brittle_nails': {'weight': 5},
  'swollen_extremeties': {'weight': 5},
  'excessive_hunger': {'weight': 4},
  'extra_marital_contacts': {'weight': 5},
  'drying_and_tingling_lips': {'weight': 4},
  'slurred_speech': {'weight': 4},
  'knee_pain': {'weight': 3},
  'hip_joint_pain': {'weight': 2},
  'muscle_weakness': {'weight': 2},
  'stiff_neck': {'weight': 4},
  'swelling_joints': {'weight': 5},
  'movement_stiffness': {'weight': 5},
  'spinning_movements': {'weight': 6},
  'loss_of_balance': {'weight': 4},
  'unsteadiness': {'weight': 4},
  'weakness_of_one_body_side': {'weight': 4},
  'loss_of_smell': {'weight': 3},
  'bladder_discomfort': {'weight': 4},
  'foul_smell_ofurine': {'weight': 5},
  'continuous_feel_of_urine': {'weight': 6},
  'passage_of_gases': {'weight': 5},
  'internal_itching': {'weight': 4},
  'toxic_look_(typhos)': {'weight': 5},
  'depression': {'weight': 3},
  'irritability': {'weight': 2},
  'muscle_pain': {'weight': 2},
  'altered_sensorium': {'weight': 2},
  'red_spots_over_body': {'weight': 3},
  'belly_pain': {'weight': 4},
  'abnormal_menstruation': {'weight': 6},
  'dischromic_patches': {'weight': 6},
  'watering_from_eyes': {'weight': 4},
  'increased_appetite': {'weight': 5},
  'polyuria': {'weight': 4},
  'family_history': {'weight': 5},
  'mucoid_sputum': {'weight': 4},
  'rusty_sputum': {'weight': 4},
  'lack_of_concentration': {'weight': 3},
  'visual_disturbances': {'weight': 3},
  'receiving_blood_transfusion': {'weight': 5},
  'receiving_unsterile_injections': {'weight': 2},
  'coma': {'weight': 7},
  'stomach_bleeding': {'weight': 6},
  'distention_of_abdomen': {'weight': 4},
  'history_of_alcohol_consumption': {'weight': 5},
  'blood_in_sputum': {'weight': 5},
  'prominent_veins_on_calf': {'weight': 6},
  'palpitations': {'weight': 4},
  'painful_walking': {'weight': 2},
  'pus_filled_pimples': {'weight': 2},
  'blackheads': {'weight': 2},
  'scurring': {'weight': 2},
  'skin_peeling': {'weight': 3},
  'silver_like_dusting': {'weight': 2},
  'small_dents_in_nails': {'weight': 2},
  'inflammatory_nails': {'weight': 2},
  'blister': {'weight': 4},
  'red_sore_around_nose': {'weight': 2},
  'yellow_crust_ooze': {'weight': 3},
  'prognosis': {'weight': 5}
}

possible_symptoms = [
  'itching', 'skin_rash', 'nodal_skin_eruptions',
  'continuous_sneezing', 'shivering', 'chills', 'joint_pain',
  'stomach_pain', 'acidity', 'ulcers_on_tongue', 'muscle_wasting',
  'vomiting', 'burning_micturition', 'spotting_urination', 'fatigue',
  'weight_gain', 'anxiety', 'cold_hands_and_feets', 'mood_swings',
  'weight_loss', 'restlessness', 'lethargy', 'patches_in_throat',
  'irregular_sugar_level', 'cough', 'high_fever', 'sunken_eyes',
  'breathlessness', 'sweating', 'dehydration', 'indigestion',
  'headache', 'yellowish_skin', 'dark_urine', 'nausea',
  'loss_of_appetite', 'pain_behind_the_eyes', 'back_pain',
  'constipation', 'abdominal_pain', 'diarrhoea', 'mild_fever',
  'yellow_urine', 'yellowing_of_eyes', 'acute_liver_failure',
  'fluid_overload', 'swelling_of_stomach', 'swelled_lymph_nodes',
  'malaise', 'blurred_and_distorted_vision', 'phlegm',
  'throat_irritation', 'redness_of_eyes', 'sinus_pressure',
  'runny_nose', 'congestion', 'chest_pain', 'weakness_in_limbs',
  'fast_heart_rate', 'pain_during_bowel_movements',
  'pain_in_anal_region', 'bloody_stool', 'irritation_in_anus',
  'neck_pain', 'dizziness', 'cramps', 'bruising', 'obesity',
  'swollen_legs', 'swollen_blood_vessels', 'puffy_face_and_eyes',
  'enlarged_thyroid', 'brittle_nails', 'swollen_extremeties',
  'excessive_hunger', 'extra_marital_contacts',
  'drying_and_tingling_lips', 'slurred_speech', 'knee_pain',
  'hip_joint_pain', 'muscle_weakness', 'stiff_neck',
  'swelling_joints', 'movement_stiffness', 'spinning_movements',
  'loss_of_balance', 'unsteadiness', 'weakness_of_one_body_side',
  'loss_of_smell', 'bladder_discomfort', 'foul_smell_ofurine',
  'continuous_feel_of_urine', 'passage_of_gases', 'internal_itching',
  'toxic_look_(typhos)', 'depression', 'irritability', 'muscle_pain',
  'altered_sensorium', 'red_spots_over_body', 'belly_pain',
  'abnormal_menstruation', 'dischromic_patches',
  'watering_from_eyes', 'increased_appetite', 'polyuria',
  'family_history', 'mucoid_sputum', 'rusty_sputum',
  'lack_of_concentration', 'visual_disturbances',
  'receiving_blood_transfusion', 'receiving_unsterile_injections',
  'coma', 'stomach_bleeding', 'distention_of_abdomen',
  'history_of_alcohol_consumption', 'blood_in_sputum',
  'prominent_veins_on_calf', 'palpitations', 'painful_walking',
  'pus_filled_pimples', 'blackheads', 'scurring', 'skin_peeling',
  'silver_like_dusting', 'small_dents_in_nails',
  'inflammatory_nails', 'blister', 'red_sore_around_nose',
  'yellow_crust_ooze', 'prognosis'
]

def load_model():
  model = pickle.load(open(os.path.join(os.path.dirname(__file__), "model.pkl"), "rb"))
  print(f'Model Type: {type(model)}')
  return model

def encode_data(dataset):
  cols = dataset.columns
  for columnName in cols:

    for i in range(len(dataset[columnName])):
      try:
        dataset[columnName][i] = data_dict[dataset[columnName][i]]["weight"]
      except Exception as e:
        print(e)

  dataset = dataset.fillna(0)  # put empty cell to 0
  dataset = dataset.replace("foul_smell_of_urine", 5)
  dataset = dataset.replace("dischromic__patches", 6)
  dataset = dataset.replace("spotting__urination", 6)
  return dataset